# Global shared configuration for all services
# This file contains environment-specific overrides and global settings
# Individual services inherit from base_config.yaml and can override these values

# ============================================================================
# GLOBAL INFRASTRUCTURE SETTINGS
# ============================================================================

# Redis configuration (global)
redis:
  host: ${REDIS_HOST:-redis}
  port: ${REDIS_PORT:-6379}
  url: ${REDIS_URL:-redis://redis:6379}

# PostgreSQL configuration (for production deployments)
postgres:
  host: ${POSTGRES_HOST:-postgres}
  port: ${POSTGRES_PORT:-5432}
  db: ${POSTGRES_DB:-doc_consistency}
  user: ${POSTGRES_USER:-doc_user}
  password: ${POSTGRES_PASSWORD:-doc_password}

# ============================================================================
# SERVICE URL CONFIGURATION
# ============================================================================

services:
  # Core services
  orchestrator_url: ${ORCHESTRATOR_URL:-http://orchestrator:5099}
  doc_store_url: ${DOC_STORE_URL:-http://doc-store:5087}
  analysis_service_url: ${ANALYSIS_SERVICE_URL:-http://analysis-service:5020}
  source_agent_url: ${SOURCE_AGENT_URL:-http://source-agent:5000}
  frontend_url: ${FRONTEND_URL:-http://frontend:3000}

  # Agent services
  memory_agent_url: ${MEMORY_AGENT_URL:-http://memory-agent:5040}
  discovery_agent_url: ${DISCOVERY_AGENT_URL:-http://discovery-agent:5045}
  github_mcp_url: ${GITHUB_MCP_URL:-http://github-mcp:5072}
  notification_service_url: ${NOTIFICATION_SERVICE_URL:-http://notification-service:5095}

  # Utility services
  prompt_store_url: ${PROMPT_STORE_URL:-http://prompt-store:5110}
  interpreter_url: ${INTERPRETER_URL:-http://interpreter:5120}
  cli_service_url: ${CLI_SERVICE_URL:-http://cli:5130}
  bedrock_proxy_url: ${BEDROCK_PROXY_URL:-http://bedrock-proxy:7090}

  # Legacy service URLs (for backward compatibility)
  github_agent_url: ${GITHUB_AGENT_URL:-http://github-agent:5000}
  jira_agent_url: ${JIRA_AGENT_URL:-http://jira-agent:5001}
  confluence_agent_url: ${CONFLUENCE_AGENT_URL:-http://confluence-agent:5050}
  swagger_agent_url: ${SWAGGER_AGENT_URL:-http://swagger-agent:5010}
  consistency_engine_url: ${CONSISTENCY_ENGINE_URL:-http://consistency-engine:5020}
  reporting_url: ${REPORTING_URL:-http://reporting:5030}
  summarizer_hub_url: ${SUMMARIZER_HUB_URL:-http://summarizer-hub:5060}
  secure_analyzer_url: ${SECURE_ANALYZER_URL:-http://secure-analyzer:5070}
  code_analyzer_url: ${CODE_ANALYZER_URL:-http://code-analyzer:5085}
  log_collector_url: ${LOG_COLLECTOR_URL:-http://log-collector:5080}

# ============================================================================
# EXTERNAL API CONFIGURATION
# ============================================================================

external:
  # GitHub API settings
  github:
    api_base: ${GITHUB_API_BASE:-https://api.github.com}
    token: ${GITHUB_TOKEN:-}
    owner: ${GITHUB_OWNER:-}

  # Jira API settings
  jira:
    base_url: ${JIRA_BASE_URL:-https://example.atlassian.net}
    email: ${JIRA_EMAIL:-}
    api_token: ${JIRA_API_TOKEN:-}

  # Confluence API settings
  confluence:
    base_url: ${CONFLUENCE_BASE_URL:-https://example.atlassian.net/wiki}
    email: ${CONFLUENCE_EMAIL:-}
    api_token: ${CONFLUENCE_API_TOKEN:-}

  # AWS settings (for Bedrock)
  aws:
    access_key_id: ${AWS_ACCESS_KEY_ID:-}
    secret_access_key: ${AWS_SECRET_ACCESS_KEY:-}
    session_token: ${AWS_SESSION_TOKEN:-}
    region: ${AWS_REGION:-us-east-1}

# ============================================================================
# GLOBAL SETTINGS
# ============================================================================

# Environment settings
environment: ${ENVIRONMENT:-development}
testing: ${TESTING:-false}

# Global limits and timeouts
limits:
  max_items: ${MAX_ITEMS:-1000}
  timeout: ${TIMEOUT:-30}
  max_connections: ${MAX_CONNECTIONS:-10}

# Logging configuration
logging:
  level: ${LOG_LEVEL:-INFO}
  format: ${LOG_FORMAT:-json}

# Health check configuration
health:
  check_interval: ${HEALTH_CHECK_INTERVAL:-30}
  timeout: ${HEALTH_TIMEOUT:-10}

# ============================================================================
# AI PROVIDER CONFIGURATION (Global defaults)
# ============================================================================

providers:
  # Ollama settings
  ollama:
    host: ${OLLAMA_HOST:-http://host.docker.internal:11434}
    model: ${OLLAMA_MODEL:-llama3}
    endpoint: ${OLLAMA_ENDPOINT:-http://ollama-consistency:11434}

  # OpenAI settings
  openai:
    model: ${OPENAI_MODEL:-gpt-4o}
    api_key: ${OPENAI_API_KEY:-}

  # Anthropic settings
  anthropic:
    model: ${ANTHROPIC_MODEL:-claude-3.5-sonnet}
    api_key: ${ANTHROPIC_API_KEY:-}

  # AWS Bedrock settings
  bedrock:
    model: ${BEDROCK_MODEL:-anthropic.claude-3-sonnet-20240229-v1:0}
    endpoint: ${BEDROCK_ENDPOINT:-}
    region: ${BEDROCK_REGION:-us-east-1}
    api_key: ${BEDROCK_API_KEY:-}

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

database:
  # SQLite paths (development)
  doc_store_path: ${DOCSTORE_DB:-services/doc-store/db.sqlite3}
  prompt_store_path: ${PROMPT_STORE_DB:-/app/data/prompt_store.db}

  # Connection settings
  connection_pool_size: ${DOCSTORE_CONNECTION_POOL_SIZE:-5}
  redis_url: ${REDIS_URL:-redis://redis:6379}
